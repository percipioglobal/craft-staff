{"version":3,"file":"employers.3c10780b.js","sources":["../../../../../buildchain/src/graphql/employers.ts","../../../../../buildchain/plugin-vue:export-helper","../../../../../buildchain/src/js/composables/useAxiosClient.ts","../../../../../buildchain/src/js/composables/useApolloClient.ts","../../src/js/employers.ts"],"sourcesContent":["import { gql } from 'graphql-tag'\n\nexport const EMPLOYERS = gql`\n    query Employers {\n        employers {\n            id\n            crn\n            name\n            employeeCount\n            currentYear\n            logoUrl\n            dateSynced:dateUpdated @formatDateTime(format:\"Y-m-d H:i\")\n            currentPayRun{\n                taxYear\n                period\n            }\n        }\n    }\n`","\nexport default (sfc, props) => {\n  const target = sfc.__vccOpts || sfc;\n  for (const [key, val] of props) {\n    target[key] = val;\n  }\n  return target;\n}\n","import axios from 'axios'\nimport { usePayRunStore } from '~/js/stores/payrun'\n\nconst ENDPOINT = window.api.cpUrl ?? 'https://localhost:8003'\n\n\nexport const fetchPayRuns = (employerId: String) => {\n\n    const store = usePayRunStore()\n    store.loadingFetched = true\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/fetch-pay-runs/${employerId}`,\n    })\n    .then(() => {\n        store.loadingFetched = false\n    })\n\n}\n\nexport const fetchPayRun = (payRunId: String) => {\n\n    const store = usePayRunStore()\n    store.loadingFetched = true\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/fetch-pay-run/${payRunId}`,\n    })\n    .then(() => {\n        store.loadingFetched = false\n    })\n\n}\n\nexport const getQueue = () => {\n\n    const store = usePayRunStore()\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/queue`,\n    })\n    .then((response) => {\n        store.queue = response?.data?.total ? response.data.total : 0\n    })\n\n}\n\nexport const getPayRunLogs = (payRunId: String) => {\n\n    const store = usePayRunStore()\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/get-logs/${payRunId}`,\n    })\n        .then((response) => {\n            store.logs = response?.data?.logs ? response.data.logs : []\n            // store.loadingFetched = false\n        })\n\n}\n\nexport const getToken = async (): Promise<string|null> => {\n\n    let token = {\n        value: null,\n    }\n\n    await axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/settings/get-gql-token`,\n    })\n    .then( (response) => {\n        token.value = response?.data?.token ? response.data.token : null\n    })\n\n    return token.value || null\n\n}","import { ApolloClient, from, InMemoryCache, HttpLink } from '@apollo/client/core'\nimport { onError } from '@apollo/client/link/error'\nimport { setContext } from '@apollo/client/link/context'\nimport { getToken } from '~/js/composables/useAxiosClient'\n\n// HTTP connection to the API\nconst httpLink = new HttpLink({\n    uri: 'http://localhost:8001/api',\n    credentials: 'include'\n})\n\nconst authLink = setContext(async (_, { headers }) => {\n    // get the authentication token from the store, if it's null fetch it through axios\n    const token = await getToken()\n\n    //const token = 'SgmAAuUYsFE0_GKOIo7deUOuZWj0yttv'\n    return {\n        headers: {\n            ...headers,\n            authorization: `Bearer ${token}`\n        }\n    }\n})\n\n// Handle errors\nconst errorLink = onError( ({ graphQLErrors, networkError, operation, forward }):any => {} )\n\nexport const defaultClient: ApolloClient = new ApolloClient({\n    cache: new InMemoryCache(),\n    link: from([ errorLink, authLink, httpLink ])\n})","import Employers from '~/vue/payrun/Employers.vue'\nimport { createApp, h, provide } from 'vue'\nimport { createPinia } from 'pinia'\nimport { DefaultApolloClient } from '@vue/apollo-composable'\nimport { defaultClient } from '~/js/composables/useApolloClient'\n\nconst employers = async () => {\n    const employers = createApp({\n        setup () {\n            provide(DefaultApolloClient, defaultClient)\n        },\n        render: () => h(Employers)\n    })\n    employers.use(createPinia())\n    const root = employers.mount('#employer-container')\n\n    return root\n}\n\nemployers().then( () => {\n    console.log()\n})"],"names":["Employers"],"mappings":"8nBAEa,GAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECDzB,MAAe,CAAC,EAAK,IAAU,CAC7B,KAAM,GAAS,EAAI,WAAa,EAChC,SAAW,CAAC,EAAK,IAAQ,GACvB,EAAO,GAAO,EAEhB,MAAO,0pGCHT,KAAM,IAAW,UAAO,IAAI,QAAX,OAAoB,yBA8DxB,GAAW,SAAkC,IAElD,GAAQ,CACR,MAAO,kBAGL,GAAM,CACR,OAAQ,MACR,IAAK,GAAG,+CAEX,KAAM,AAAC,GAAa,SACX,MAAQ,qBAAU,OAAV,cAAgB,OAAQ,EAAS,KAAK,MAAQ,OAGzD,EAAM,OAAS,MCzEpB,GAAW,GAAI,GAAS,CAC1B,IAAK,4BACL,YAAa,YAGX,GAAW,EAAW,MAAO,EAAG,CAAE,aAAc,MAE5C,GAAQ,KAAM,YAGb,CACH,QAAS,OACF,GADE,CAEL,cAAe,UAAU,SAM/B,GAAY,EAAS,CAAC,CAAE,gBAAe,eAAc,YAAW,aAAkB,IAE3E,GAA8B,GAAI,GAAa,CACxD,MAAO,GAAI,GACX,KAAM,EAAK,CAAE,GAAW,GAAU,OCvBhC,GAAY,SAAY,MACpB,GAAY,EAAU,CACxB,OAAS,GACG,EAAqB,KAEjC,OAAQ,IAAM,EAAEA,eAEV,IAAI,KACD,EAAU,MAAM,wBAKjC,KAAY,KAAM,IAAM,SACZ"}