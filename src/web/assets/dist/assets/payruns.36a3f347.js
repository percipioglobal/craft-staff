import{d as w,o as n,c as d,r as C,f as t,a as e,n as $,t as l,F as v,q as D,u as S,x as b,b as p,e as P,h as A,i as L,j as R,y as j,p as B,D as F}from"./vendor.a01131e1.js";import{u as I,a as N,d as V}from"./useApolloClient.4f887e84.js";import{f as z,_ as U,a as E}from"./status--synced.0b3f8fc9.js";import{L as O}from"./listitem--loading.69eca668.js";const T=["href","title"],q={class:"flex items-center whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-indigo-800 sm:pl-6"},G={class:"hide lg:flex lg:items-center whitespace-nowrap px-3 py-4 text-sm text-gray-500"},H={class:"hide lg:flex lg:items-center col-span-2 whitespace-nowrap px-3 py-4 text-sm text-gray-500"},M={class:"hide lg:flex lg:items-center whitespace-nowrap px-3 py-4 text-sm text-gray-500"},Q={class:"flex items-center whitespace-nowrap px-3 py-4 text-sm text-gray-500"},J={class:"flex items-center whitespace-nowrap px-3 py-4 text-sm text-gray-500"},K=w({props:{payrunData:Object},setup(m){const o=window.location.href.split("/").pop();return(a,x)=>(n(!0),d(v,null,C(m.payrunData,s=>(n(),d("a",{key:s.id,href:`/admin/staff-management/pay-runs/${s.employerId}/${t(o)}/${s.id}`,title:`Go to pay run ${s.period}/${s.taxYear}`,class:"grid grid-cols-4 lg:grid-cols-7 border-b border-solid border-gray-200 no-underline hover:bg-gray-200"},[e("div",q,[e("span",{class:$(["rounded-full w-5 h-5 fond-bold flex items-center justify-center mb-0",s.state=="Open"?"border-2 border-solid border-emrald-500 text-emerald-500":"",s.state=="Closed"?"border-2 border-solid border-green-500 text-white bg-emerald-500":"",s.state=="Finalised"?"border-2 border-solid border-green-500 text-white bg-emerald-500":""])},l(s.period),3)]),e("div",G,l(s.employeeCount),1),e("div",H,l(s.startDate)+" - "+l(s.endDate),1),e("div",M,"\xA3 "+l(t(z)(s.totals.totalCost)),1),e("div",Q,l(s.paymentDate),1),e("div",J,l(s.dateSynced),1)],8,T))),128))}}),W={key:0,class:"md:flex items-start"},X={class:"flex-grow pr-4",style:{"margin-bottom":"0"}},Z={class:"flex items-center"},ee=["title"],te={class:"ml-1 text-xl font-semibold text-gray-900"},se={class:"mt-2 text-sm text-gray-700"},oe={class:"mt-4 md:mt-0 flex",style:{"margin-bottom":"0"}},re=["disabled"],ae=e("span",null,"Refresh Pay Runs",-1),ie={key:0,class:"animate-spin ml-1 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",style:{"margin-bottom":"0"}},ne=e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),le=e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),de=[ne,le],ce={key:1,class:"mt-8 ml-auto grid grid-cols-4"},pe={class:"col-start-4 flex justify-end"},me=e("span",{class:"mb-1 mr-2 font-bold"},"Choose a payroll year:",-1),ue=["selected"],he=["selected"],ge=["selected"],xe=["selected"],fe=["selected"],ye={key:2,class:"mt-2 flex flex-col w-full"},_e={class:"-my-2 overflow-x-auto w-full"},be={class:"inline-block min-w-full py-2 align-middle"},we={class:"overflow-hidden shadow border border-solid border-gray-300 md:rounded-lg"},ve=A('<div class="grid grid-cols-4 lg:grid-cols-7 border-b border-solid border-gray-300"><div class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6">Period</div><div class="hide lg:block px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Entries</div><div class="hide lg:block col-span-2 px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Dates</div><div class="hide lg:block px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Cost</div><div class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Pay Date</div><div class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Last synced</div></div>',1),ke={key:1,class:"grid grid-cols-7 border-b border-solid border-gray-200 py-4 px-3 text-center"},Ye=e("div",{class:"col-span-7"},"There are currently no pay runs for this employer",-1),Ce=[Ye],$e=w({setup(m){const o=D({taxYear:window.location.href.split("/").pop(),employerId:window.location.href.split("/").at(-2)}),{result:a,loading:x,refetch:s}=S(E,o,{pollInterval:5e3}),f=I(),k=c=>{if(!c)return"unknown";const r=c.map(i=>i.dateSynced).sort((i,h)=>i<h);return r.length>0?r[0]:"unknown"},Y=c=>{const r=new URL(window.location.href),i=r.pathname.split("/");i.pop(),r.pathname=i.join("/")+"/"+c,window.history.pushState({},"",r),o.taxYear=c};return(c,r)=>{var i,h,y;return n(),d(v,null,[t(a)?(n(),d("div",W,[e("div",X,[e("div",Z,[e("a",{href:"/admin/staff-management/pay-runs",title:`Back to ${(i=t(a).payruns[0])==null?void 0:i.employer}`,class:"inline-flex no-underline items-center px-2.5 py-1.5 rounded-full text-sm text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",style:{"margin-bottom":"0"}},"\u2190",8,ee),e("h1",te,l((h=t(a).payruns[0])==null?void 0:h.employer),1)]),e("p",se,"The table below shows payrun overviews for "+l((y=t(a).payruns[0])==null?void 0:y.employer)+". If a payrun has recently been setup in Staffology but does not yet appear below, click the Fetch\xA0Pay\xA0Runs button to update. ",1)]),e("div",oe,[b(U,{date:k(t(a).payruns)},null,8,["date"]),e("button",{onClick:r[0]||(r[0]=g=>{var u,_;return t(N)((u=t(o))==null?void 0:u.employerId,(_=t(o))==null?void 0:_.taxYear)}),disabled:t(f).loadingFetched,class:"cursor-pointer inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-600 disabled:bg-indigo-400 disabled:cursor-not-allowed px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:w-auto",style:{"margin-bottom":"0"}},[ae,t(f).loadingFetched?(n(),d("svg",ie,de)):p("",!0)],8,re)])])):p("",!0),t(a)?(n(),d("div",ce,[e("div",pe,[me,e("select",{class:"py-1 px-1 rounded-md bg-gray-100 border-2 border-indigo-600 text-right",onChange:r[1]||(r[1]=g=>{var u;return Y((u=g==null?void 0:g.target)==null?void 0:u.value)})},[e("option",{value:"Year2022",selected:t(o).taxYear==="Year2022"},"2022",8,ue),e("option",{value:"Year2021",selected:t(o).taxYear==="Year2021"},"2021",8,he),e("option",{value:"Year2020",selected:t(o).taxYear==="Year2020"},"2020",8,ge),e("option",{value:"Year2019",selected:t(o).taxYear==="Year2019"},"2019",8,xe),e("option",{value:"Year2018",selected:t(o).taxYear==="Year2018"},"2018",8,fe)],32)])])):p("",!0),t(a)?(n(),d("div",ye,[e("div",_e,[e("div",be,[e("div",we,[ve,t(x)?(n(),P(O,{key:0})):p("",!0),!t(x)&&t(a).payruns.length===0?(n(),d("div",ke,Ce)):p("",!0),b(K,{"payrun-data":t(a).payruns},null,8,["payrun-data"])])])])])):p("",!0)],64)}}}),De=async()=>{const m=L({setup(){B(F,V)},render:()=>R($e)});return m.use(j()),m.mount("#payruns-container")};De().then(()=>{console.log()});
//# sourceMappingURL=payruns.36a3f347.js.map
