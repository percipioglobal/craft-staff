{"version":3,"file":"useApolloClient.7975f0d6.js","sources":["../../../../../buildchain/plugin-vue:export-helper","../../../../../buildchain/src/stores/payrun.ts","../../../../../buildchain/src/js/composables/useAxiosClient.ts","../../../../../buildchain/src/js/composables/useApolloClient.ts"],"sourcesContent":["\nexport default (sfc, props) => {\n  const target = sfc.__vccOpts || sfc;\n  for (const [key, val] of props) {\n    target[key] = val;\n  }\n  return target;\n}\n","import { defineStore } from 'pinia'\n\nexport const usePayRunStore = defineStore('payrun', {\n    state: () => ({\n        queue: 0,\n        fetching: false,\n        logs: []\n    })\n})","import axios from 'axios'\nimport { usePayRunStore } from '~/stores/payrun'\n\nconst ENDPOINT = window.api.cpUrl ?? 'https://localhost:8003'\n\n\nexport const fetchPayRuns = (employerId: String) => {\n\n    const store = usePayRunStore()\n    store.loadingFetched = true\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/fetch-pay-runs/${employerId}`,\n    })\n    .then(() => {\n        store.loadingFetched = false\n    })\n\n}\n\nexport const fetchPayRun = (payRunId: String) => {\n\n    const store = usePayRunStore()\n    store.loadingFetched = true\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/fetch-pay-run/${payRunId}`,\n    })\n    .then(() => {\n        store.loadingFetched = false\n    })\n\n}\n\nexport const getQueue = () => {\n\n    const store = usePayRunStore()\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/queue`,\n    })\n    .then((response) => {\n        store.queue = response?.data?.total ? response.data.total : 0\n    })\n\n}\n\nexport const getPayRunLogs = (payRunId: String) => {\n\n    const store = usePayRunStore()\n\n    axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/pay-runs/get-logs/${payRunId}`,\n    })\n        .then((response) => {\n            store.logs = response?.data?.logs ? response.data.logs : []\n            // store.loadingFetched = false\n        })\n\n}\n\nexport const getToken = async (): Promise<string|null> => {\n\n    let token = {\n        value: null,\n    }\n\n    await axios({\n        method: 'get',\n        url: `${ENDPOINT}/staff-management/settings/get-gql-token`,\n    })\n    .then( (response) => {\n        token.value = response?.data?.token ? response.data.token : null\n    })\n\n    return token.value || null\n\n}","import { ApolloClient, from, InMemoryCache, HttpLink } from '@apollo/client/core'\nimport { onError } from '@apollo/client/link/error'\nimport { setContext } from '@apollo/client/link/context'\nimport { getToken } from '~/js/composables/useAxiosClient'\n\n// HTTP connection to the API\nconst httpLink = new HttpLink({\n    uri: 'http://localhost:8001/api',\n    credentials: 'include'\n})\n\nconst authLink = setContext(async (_, { headers }) => {\n    // get the authentication token from the store, if it's null fetch it through axios\n    const token = await getToken()\n\n    //const token = 'SgmAAuUYsFE0_GKOIo7deUOuZWj0yttv'\n    return {\n        headers: {\n            ...headers,\n            authorization: `Bearer ${token}`\n        }\n    }\n})\n\n// Handle errors\nconst errorLink = onError( ({ graphQLErrors, networkError, operation, forward }):any => {} )\n\nexport const defaultClient: ApolloClient = new ApolloClient({\n    cache: new InMemoryCache(),\n    link: from([ errorLink, authLink, httpLink ])\n})"],"names":[],"mappings":"4hBACA,MAAe,CAAC,EAAK,IAAU,CAC7B,KAAM,GAAS,EAAI,WAAa,EAChC,SAAW,CAAC,EAAK,IAAQ,GACvB,EAAO,GAAO,EAEhB,MAAO,4nBCJI,GAAiB,EAAY,SAAU,CAChD,MAAO,MACH,MAAO,EACP,SAAU,GACV,KAAM,aCHd,KAAM,GAAW,UAAO,IAAI,QAAX,OAAoB,yBAGxB,EAAe,AAAC,GAAuB,MAE1C,GAAQ,MACR,eAAiB,KAEjB,CACF,OAAQ,MACR,IAAK,GAAG,8CAAqD,MAEhE,KAAK,IAAM,GACF,eAAiB,MAKlB,EAAc,AAAC,GAAqB,MAEvC,GAAQ,MACR,eAAiB,KAEjB,CACF,OAAQ,MACR,IAAK,GAAG,6CAAoD,MAE/D,KAAK,IAAM,GACF,eAAiB,MAKlB,EAAW,IAAM,MAEpB,GAAQ,MAER,CACF,OAAQ,MACR,IAAK,GAAG,sCAEX,KAAK,AAAC,GAAa,SACV,MAAQ,qBAAU,OAAV,cAAgB,OAAQ,EAAS,KAAK,MAAQ,KAKvD,EAAgB,AAAC,GAAqB,MAEzC,GAAQ,MAER,CACF,OAAQ,MACR,IAAK,GAAG,wCAA+C,MAEtD,KAAK,AAAC,GAAa,SACV,KAAO,qBAAU,OAAV,cAAgB,MAAO,EAAS,KAAK,KAAO,MAMxD,EAAW,SAAkC,IAElD,GAAQ,CACR,MAAO,kBAGL,GAAM,CACR,OAAQ,MACR,IAAK,GAAG,8CAEX,KAAM,AAAC,GAAa,SACX,MAAQ,qBAAU,OAAV,cAAgB,OAAQ,EAAS,KAAK,MAAQ,OAGzD,EAAM,OAAS,MCzEpB,EAAW,GAAI,GAAS,CAC1B,IAAK,4BACL,YAAa,YAGX,EAAW,EAAW,MAAO,EAAG,CAAE,aAAc,MAE5C,GAAQ,KAAM,WAGb,CACH,QAAS,OACF,GADE,CAEL,cAAe,UAAU,SAM/B,EAAY,EAAS,CAAC,CAAE,gBAAe,eAAc,YAAW,aAAkB,IAE3E,EAA8B,GAAI,GAAa,CACxD,MAAO,GAAI,GACX,KAAM,EAAK,CAAE,EAAW,EAAU"}